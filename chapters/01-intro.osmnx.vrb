\frametitle{Generación de Datos de Inundaciones}
\phantomsection\label{generaciuxf3n-de-datos-de-inundaciones}
\phantomsection\label{gen-datos}
\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# =============================}
\CommentTok{\# 1. IMPORTAR LIBRERÍAS Y GENERAR DATOS DE INUNDACIONES}
\CommentTok{\# ===============================}
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np}
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd}
\ImportTok{import}\NormalTok{ matplotlib.pyplot }\ImportTok{as}\NormalTok{ plt}
\ImportTok{import}\NormalTok{ tensorflow }\ImportTok{as}\NormalTok{ tf}
\ImportTok{from}\NormalTok{ tensorflow.keras.models }\ImportTok{import}\NormalTok{ Sequential}
\ImportTok{from}\NormalTok{ tensorflow.keras.layers }\ImportTok{import}\NormalTok{ LSTM, Dense, Dropout, Input}
\ImportTok{from}\NormalTok{ tensorflow.keras.optimizers }\ImportTok{import}\NormalTok{ Adam}
\ImportTok{from}\NormalTok{ tensorflow.keras.callbacks }\ImportTok{import}\NormalTok{ EarlyStopping}
\ImportTok{from}\NormalTok{ sklearn.preprocessing }\ImportTok{import}\NormalTok{ MinMaxScaler}
\ImportTok{from}\NormalTok{ sklearn.metrics }\ImportTok{import}\NormalTok{ accuracy\_score, classification\_report, confusion\_matrix}
\ImportTok{from}\NormalTok{ tensorflow.keras.metrics }\ImportTok{import}\NormalTok{ Precision, Recall}

\CommentTok{\# Configurar semilla para reproducibilidad}
\NormalTok{np.random.seed(}\DecValTok{123}\NormalTok{)}
\NormalTok{tf.random.set\_seed(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# Generar datos }
\NormalTok{n }\OperatorTok{=} \DecValTok{500}  \CommentTok{\# Más datos para mejor entrenamiento LSTM}

\NormalTok{lluvia\_total }\OperatorTok{=}\NormalTok{ np.random.gamma(shape}\OperatorTok{=}\DecValTok{3}\NormalTok{, scale}\OperatorTok{=}\DecValTok{25}\NormalTok{, size}\OperatorTok{=}\NormalTok{n)}
\NormalTok{intensidad\_lluvia }\OperatorTok{=}\NormalTok{ np.random.gamma(shape}\OperatorTok{=}\DecValTok{2}\NormalTok{, scale}\OperatorTok{=}\DecValTok{15}\NormalTok{, size}\OperatorTok{=}\NormalTok{n)}
\NormalTok{duracion\_lluvia }\OperatorTok{=}\NormalTok{ np.random.lognormal(mean}\OperatorTok{=}\NormalTok{np.log(}\DecValTok{2}\NormalTok{), sigma}\OperatorTok{=}\FloatTok{0.4}\NormalTok{, size}\OperatorTok{=}\NormalTok{n)}
\NormalTok{capacidad\_drenaje }\OperatorTok{=}\NormalTok{ np.random.lognormal(mean}\OperatorTok{=}\NormalTok{np.log(}\DecValTok{60}\NormalTok{), sigma}\OperatorTok{=}\FloatTok{0.3}\NormalTok{, size}\OperatorTok{=}\NormalTok{n)}
\NormalTok{impermeabilidad }\OperatorTok{=}\NormalTok{ np.random.beta(a}\OperatorTok{=}\DecValTok{5}\NormalTok{, b}\OperatorTok{=}\DecValTok{2}\NormalTok{, size}\OperatorTok{=}\NormalTok{n)}

\CommentTok{\# Calcular riesgo }
\NormalTok{riesgo }\OperatorTok{=}\NormalTok{ (}
    \FloatTok{0.6} \OperatorTok{*}\NormalTok{ (lluvia\_total }\OperatorTok{/} \DecValTok{80}\NormalTok{) }\OperatorTok{+}           \CommentTok{\# Escala mejorada}
    \FloatTok{0.5} \OperatorTok{*}\NormalTok{ (intensidad\_lluvia }\OperatorTok{/} \DecValTok{60}\NormalTok{) }\OperatorTok{+}      \CommentTok{\# Más peso a intensidad}
    \FloatTok{0.6} \OperatorTok{*}\NormalTok{ (impermeabilidad }\OperatorTok{*} \FloatTok{1.2}\NormalTok{) }\OperatorTok{+}       \CommentTok{\# Impermeabilidad escalada}
    \OperatorTok{{-}}\FloatTok{0.7} \OperatorTok{*}\NormalTok{ (capacidad\_drenaje }\OperatorTok{/} \DecValTok{50}\NormalTok{) }\OperatorTok{+}     \CommentTok{\# Más impacto del drenaje}
    \FloatTok{0.4} \OperatorTok{*}\NormalTok{ (duracion\_lluvia }\OperatorTok{/} \DecValTok{5}\NormalTok{)           }\CommentTok{\# Duración con mejor escala}
\NormalTok{)}

\CommentTok{\# Probabilidad de inundación}
\NormalTok{prob\_inundacion }\OperatorTok{=} \DecValTok{1} \OperatorTok{/}\NormalTok{ (}\DecValTok{1} \OperatorTok{+}\NormalTok{ np.exp(}\OperatorTok{{-}}\DecValTok{5} \OperatorTok{*}\NormalTok{ (riesgo }\OperatorTok{{-}} \FloatTok{0.5}\NormalTok{)))}
\NormalTok{zona\_inundada }\OperatorTok{=}\NormalTok{ np.random.binomial(}\DecValTok{1}\NormalTok{, prob\_inundacion)}

\CommentTok{\# Crear DataFrame}
\NormalTok{df }\OperatorTok{=}\NormalTok{ pd.DataFrame(\{}
    \StringTok{\textquotesingle{}lluvia\_total\textquotesingle{}}\NormalTok{: lluvia\_total,}
    \StringTok{\textquotesingle{}intensidad\_lluvia\textquotesingle{}}\NormalTok{: intensidad\_lluvia,}
    \StringTok{\textquotesingle{}duracion\_lluvia\textquotesingle{}}\NormalTok{: duracion\_lluvia,}
    \StringTok{\textquotesingle{}capacidad\_drenaje\textquotesingle{}}\NormalTok{: capacidad\_drenaje,}
    \StringTok{\textquotesingle{}impermeabilidad\textquotesingle{}}\NormalTok{: impermeabilidad,}
    \StringTok{\textquotesingle{}zona\_inundada\textquotesingle{}}\NormalTok{: zona\_inundada}
\NormalTok{\})}

\BuiltInTok{print}\NormalTok{(}\StringTok{"✅ Datos generados exitosamente"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"📊 Dimensiones: }\SpecialCharTok{\{}\NormalTok{df}\SpecialCharTok{.}\NormalTok{shape}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(}\SpecialStringTok{f"🎯 Balance de clases: }\SpecialCharTok{\{}\NormalTok{df[}\StringTok{\textquotesingle{}zona\_inundada\textquotesingle{}}\NormalTok{]}\SpecialCharTok{.}\NormalTok{value\_counts()}\SpecialCharTok{.}\NormalTok{to\_dict()}\SpecialCharTok{\}}\SpecialStringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
✅ Datos generados exitosamente
📊 Dimensiones: (500, 6)
🎯 Balance de clases: {1: 299, 0: 201}
\end{verbatim}

\phantomsection\label{stats-datos}
\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{📈 ESTADÍSTICAS DESCRIPTIVAS:"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(df.describe().}\BuiltInTok{round}\NormalTok{(}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

📈 ESTADÍSTICAS DESCRIPTIVAS:
       lluvia_total  intensidad_lluvia  duracion_lluvia  capacidad_drenaje  \
count       500.000            500.000          500.000            500.000
mean         76.108             30.486            2.218             62.867
std          43.124             20.247            0.849             18.576
min           2.631              1.513            0.586             26.897
25%          46.571             14.664            1.575             49.747
50%          67.206             27.152            2.111             60.857
75%          99.123             40.958            2.705             73.305
max         344.610            108.240            5.629            138.648

       impermeabilidad  zona_inundada
count          500.000        500.000
mean             0.712          0.598
std              0.159          0.491
min              0.210          0.000
25%              0.611          0.000
50%              0.734          1.000
75%              0.838          1.000
max              0.992          1.000
\end{verbatim}

\phantomsection\label{head-datos}
\begin{Shaded}
\begin{Highlighting}[]
\BuiltInTok{print}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{📋 MUESTRA DE DATOS (primeras 5 filas):"}\NormalTok{)}
\BuiltInTok{print}\NormalTok{(df.head().}\BuiltInTok{round}\NormalTok{(}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

📋 MUESTRA DE DATOS (primeras 5 filas):
   lluvia_total  intensidad_lluvia  duracion_lluvia  capacidad_drenaje  \
0        31.442             12.191            2.156             74.764
1       116.235             64.126            3.618             75.055
2        45.725             48.992            1.324             61.771
3       159.367             49.733            0.696             70.290
4         8.568              5.253            3.794             44.810

   impermeabilidad  zona_inundada
0            0.825              0
1            0.859              1
2            0.335              1
3            0.858              1
4            0.745              0
\end{verbatim}

\begin{verbatim}

🕐 SECUENCIAS TEMPORALES CREADAS (CORREGIDO)
Time steps por secuencia: 15
Forma de X_sequences: (485, 15, 5)
Forma de y_sequences: (485,)

📊 DIVISIÓN DE DATOS:
Entrenamiento: 388 secuencias
Prueba: 97 secuencias
Características por time step: 5
\end{verbatim}

\begin{verbatim}

🏗️ ARQUITECTURA DEL MODELO:
\end{verbatim}

\begin{verbatim}
Model: "sequential"
\end{verbatim}

\begin{verbatim}
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 64)             │        17,920 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 64)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 32)             │         2,080 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 32)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_1 (Dense)                 │ (None, 32)             │         1,056 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_2 (Dropout)             │ (None, 32)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_2 (Dense)                 │ (None, 1)              │            33 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
\end{verbatim}

\begin{verbatim}
 Total params: 21,089 (82.38 KB)
\end{verbatim}

\begin{verbatim}
 Trainable params: 21,089 (82.38 KB)
\end{verbatim}

\begin{verbatim}
 Non-trainable params: 0 (0.00 B)
\end{verbatim}

\begin{verbatim}
🚀 INICIANDO ENTRENAMIENTO LSTM
==================================================
Epoch 1/100
